<!doctype html>
<html lang="fr" data-theme="dark">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>TriSports ‚Äî Tournoi</title>
  <!-- SEO & Social -->
  <meta name="description" content="Tournois TriSports : fl√©chettes, ping-pong & palet ‚Äî cr√©e, organise et tiens le classement en temps r√©el.">
  <meta name="theme-color" content="#1b2242" media="(prefers-color-scheme: dark)">
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
  <meta property="og:title" content="TriSports ‚Äî Tournoi">
  <meta property="og:description" content="Organise un tournoi multi-sports et suis les scores en direct.">
  <meta property="og:image" content="img/preview.jpg">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">

  <!-- Preconnects (si Firebase/Google utilis√©s) -->
  <link rel="preconnect" href="https://www.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://firebaseinstallations.googleapis.com" crossorigin>

  <!-- Styles -->
  <link rel="stylesheet" href="trisports-theme-pack.css">
</head>
<body>
  <header>
    <div class="bar">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <h1>TriSports ‚Äî Tournoi</h1>
      </div>
      <div class="actions">
        <button class="btn small" id="btn-theme" title="Basculer clair/sombre" aria-pressed="false">‚òÄÔ∏è/üåô</button>
        <button class="btn small ghost" id="btn-full">Plein √©cran</button>
        <button class="btn primary" id="btn-cloud">Cloud</button>
      </div>
    </div>
  </header>

  <main class="container">
    <div class="grid" role="application">
      <aside class="card">
        <h2>Navigation</h2>
        <nav class="tabs" role="tablist" aria-label="Sections" id="tabs">
          <button class="tab" role="tab" id="tab-setup" aria-selected="true" aria-controls="panel-setup">Tournoi</button>
          <button class="tab" role="tab" id="tab-equipes" aria-selected="false" aria-controls="panel-equipes">√âquipes</button>
          <button class="tab" role="tab" id="tab-rencontres" aria-selected="false" aria-controls="panel-rencontres">Rencontres</button>
          <button class="tab" role="tab" id="tab-classement" aria-selected="false" aria-controls="panel-classement">Classement</button>
          <button class="tab" role="tab" id="tab-bonus" aria-selected="false" aria-controls="panel-bonus">Bonus</button>
        </nav>
      </aside>

      <section class="panels">
        <section id="panel-setup" role="tabpanel" aria-labelledby="tab-setup" class="card active">
          <h2>Param√®tres du tournoi</h2>
          <div class="row">
            <label>Nom <input type="text" placeholder="TriSports Cup"></label>
            <label>Date <input type="date"></label>
            <span class="spacer"></span>
            <button class="btn">Exporter</button>
            <button class="btn ghost">Options</button>
          </div>
        </section>

        <section id="panel-equipes" role="tabpanel" aria-labelledby="tab-equipes" class="card">
          <h2>√âquipes</h2>
          <p class="muted">Ajoute, √©dite et ordonne les √©quipes du tournoi.</p>
          <div class="row"><button class="btn">+ Ajouter une √©quipe</button></div>
        </section>

        <section id="panel-rencontres" role="tabpanel" aria-labelledby="tab-rencontres" class="card">
          <h2>Rencontres</h2>
          <p class="muted">Planifie et suit les matchs (fl√©chettes, ping-pong, palet).</p>
          <div class="row"><button class="btn">+ Nouvelle rencontre</button></div>
        </section>

        <section id="panel-classement" role="tabpanel" aria-labelledby="tab-classement" class="card">
          <h2>Classement</h2>
          <table aria-describedby="classement-help">
            <thead><tr><th>#</th><th>√âquipe</th><th>Pts</th><th>V</th><th>D</th></tr></thead>
            <tbody>
              <tr><td>1</td><td>Orion</td><td>9</td><td>3</td><td>0</td></tr>
              <tr><td>2</td><td>√âclipse</td><td>6</td><td>2</td><td>1</td></tr>
              <tr><td>3</td><td>Nova</td><td>3</td><td>1</td><td>2</td></tr>
            </tbody>
          </table>
          <p id="classement-help" class="muted">Classement g√©n√©ral cumul√© tous sports.</p>
        </section>

        <section id="panel-bonus" role="tabpanel" aria-labelledby="tab-bonus" class="card">
          <div class="row">
            <h2 class="spacer">Bonus</h2>
            <button class="btn" id="bonus-open">Choisir un bonus</button>
          </div>
          <p class="muted">Ajoute des modificateurs amusants pour pimenter les matchs.</p>
        </section>
      </section>
    </div>
  </main>

  <!-- Toast d‚Äô√©tat (aria-live) -->
  <div class="toast" role="status" aria-live="polite" id="toast" hidden>√âtat synchronis√©.</div>

  <!-- MODAL BONUS accessible -->
  <div class="modal" id="bonus-modal" role="dialog" aria-modal="true" aria-labelledby="bonus-title" hidden>
    <div class="bonus-dialog card">
      <div class="row" style="margin-bottom:8px">
        <h2 id="bonus-title" class="spacer">Choisir un bonus</h2>
        <button class="btn ghost" id="bonus-cancel" aria-label="Fermer le modal">Fermer ‚úï</button>
      </div>
      <div class="bonus-grid">
        <button class="bonus-card" data-bonus="main-gauche">
          <div class="bonus-illu" aria-hidden="true">
            <img src="img/main-gauche.png" alt="" width="40" height="40" loading="lazy" decoding="async">
          </div>
          <div>
            <div><strong>Main faible</strong></div>
            <div class="muted">Le joueur utilise sa main non dominante.</div>
          </div>
        </button>
        <button class="bonus-card" data-bonus="miroir">
          <div class="bonus-illu" aria-hidden="true">
            <img src="img/miroir.png" alt="" width="40" height="40" loading="lazy" decoding="async">
          </div>
          <div>
            <div><strong>Effet miroir</strong></div>
            <div class="muted">Le coup doit √™tre sym√©trique au pr√©c√©dent.</div>
          </div>
        </button>
        <button class="bonus-card" data-bonus="capitaine">
          <div class="bonus-illu" aria-hidden="true">
            <img src="img/capitaine.png" alt="" width="40" height="40" loading="lazy" decoding="async">
          </div>
          <div>
            <div><strong>Capitaine √ó2</strong></div>
            <div class="muted">Les points du capitaine comptent double.</div>
          </div>
        </button>
      </div>
      <div class="row" style="margin-top:12px">
        <span class="muted">S√©lectionne un bonus pour l‚Äôappliquer au prochain match.</span>
        <span class="spacer"></span>
        <button class="btn primary" id="bonus-apply">Appliquer</button>
      </div>
    </div>
  </div>

  <script>
  // --- Th√®me clair/sombre ----------------------------------------------------
  (function(){
    const html = document.documentElement;
    const key = 'trisports_theme';
    const btn = document.getElementById('btn-theme');
    const saved = localStorage.getItem(key);
    if(saved){
      if(saved==='light') html.setAttribute('data-theme','light');
      else html.removeAttribute('data-theme');
      btn?.setAttribute('aria-pressed', saved==='light');
    }
    btn?.addEventListener('click',()=>{
      const next = html.getAttribute('data-theme')==='light' ? 'dark' : 'light';
      if(next==='dark') html.removeAttribute('data-theme'); else html.setAttribute('data-theme','light');
      localStorage.setItem(key,next);
      btn.setAttribute('aria-pressed', next==='light');
    });
  })();

  // --- Plein √©cran -----------------------------------------------------------
  document.getElementById('btn-full')?.addEventListener('click',()=>{
    const el = document.documentElement;
    if(!document.fullscreenElement){ el.requestFullscreen?.(); }
    else{ document.exitFullscreen?.(); }
  });

  // --- Tabs accessibles (ARIA + clavier) ------------------------------------
  (function(){
    const list = document.getElementById('tabs');
    const tabs = Array.from(list?.querySelectorAll('[role="tab"]')||[]);
    const panels = tabs.map(t=> document.getElementById(t.getAttribute('aria-controls')));

    function setActive(i){
      tabs.forEach((t,idx)=>{
        const selected = idx===i;
        t.setAttribute('aria-selected', selected);
        t.tabIndex = selected?0:-1;
        panels[idx]?.classList.toggle('active', selected);
      });
      tabs[i]?.focus();
    }
    tabs.forEach((t,i)=>{
      t.addEventListener('click',()=> setActive(i));
      t.addEventListener('keydown',(e)=>{
        const key = e.key;
        if(key==='ArrowRight') setActive((i+1)%tabs.length);
        else if(key==='ArrowLeft') setActive((i-1+tabs.length)%tabs.length);
        else if(key==='Home') setActive(0);
        else if(key==='End') setActive(tabs.length-1);
      });
    });
  })();

  // --- Modal Bonus accessible (focus trap + ESC) ----------------------------
  (function(){
    const modal = document.getElementById('bonus-modal');
    const openBtn = document.getElementById('bonus-open');
    const cancelBtn = document.getElementById('bonus-cancel');
    const applyBtn = document.getElementById('bonus-apply');
    const cards = ()=> Array.from(modal.querySelectorAll('.bonus-card'));
    let lastFocus=null, chosen=null;

    function open(){
      lastFocus=document.activeElement; modal.hidden=false; modal.classList.add('show');
      cards()[0]?.focus();
      document.addEventListener('keydown', onKey);
    }
    function close(){
      modal.classList.remove('show'); modal.hidden=true; document.removeEventListener('keydown', onKey);
      lastFocus?.focus();
    }
    function onKey(e){
      if(e.key==='Escape') return close();
      if(e.key==='Tab'){
        const focusables = cards().concat([document.getElementById('bonus-apply'), document.getElementById('bonus-cancel')]);
        const idx = focusables.indexOf(document.activeElement);
        const next = (idx + (e.shiftKey?-1:1) + focusables.length) % focusables.length;
        focusables[next]?.focus(); e.preventDefault();
      }
    }
    openBtn?.addEventListener('click', open);
    cancelBtn?.addEventListener('click', close);

    modal.addEventListener('click', (e)=>{ if(e.target===modal) close(); });
    modal.addEventListener('keydown', (e)=>{ if(e.key==='Enter' && document.activeElement.classList.contains('bonus-card')){ chosen=document.activeElement.dataset.bonus; }});
    modal.addEventListener('focusin', (e)=>{ if(e.target.classList?.contains('bonus-card')) chosen=e.target.dataset.bonus; });

    applyBtn?.addEventListener('click', ()=>{
      close();
      const toast = document.getElementById('toast');
      if(chosen){ toast.textContent = `Bonus appliqu√© : ${chosen}`; }
      else{ toast.textContent = `Aucun bonus s√©lectionn√©`; }
      toast.hidden=false; setTimeout(()=> toast.hidden=true, 2500);
    });
  })();

  // --- (Optionnel) Chargement diff√©r√© Firebase au clic Cloud -----------------
  (function(){
    const cloudBtn = document.getElementById('btn-cloud');
    let loaded=false;
    cloudBtn?.addEventListener('click', async ()=>{
      if(loaded) return; loaded=true;
      // Exemple: charge Firebase on-demand (remplace par tes modules r√©els)
      // const { initializeApp } = await import('https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js');
      // ... init + auth ...
      const toast = document.getElementById('toast');
      toast.textContent = 'Module Cloud initialis√©'; toast.hidden=false; setTimeout(()=> toast.hidden=true, 2200);
    });
  })();
  </script>
</body>
</html>
